import pandas as pd
from sqlalchemy import create_engine

engine = create_engine('mysql+pymysql://ddadmin:San3Er2Yi1@rm-bp17em0iz2a80q5khlo.mysql.rds.aliyuncs.com:3306/dn_ml')
sql = ''' 
select  
TICKER_SYMBOL ,	 
TRADE_DATE  date,
OPEN_PRICE_2 open, 
HIGHEST_PRICE_2 high, 
LOWEST_PRICE_2 low, 
CLOSE_PRICE_2  close
 from org_dn_mkt_equd_adj_af where ticker_symbol in (
'600276','601318','600036','002475','000858','601066','002142','601100',
'300760','300015','002714','603288','600588','603160','002352','600585',
'603517','600519','300463','601166','601628','300059','600570','000860',
'603737','000568','002544','603658','600745','600438','603899','601012',
'600048','000002','002146','600926','601155','601985','600009','603986',
'600352','300482','000651','603588','603939','300595','000333','603883',
'002690','300033','000977','300315','002555','300498','603568','300012',
'000661','300699','601236','600030','600837','601990','002179','600720',
'600000','002048','603501','300253','603129','601186','601117','002557',
'002216','002081','300347','002916','600305','002353','002463','300628',
'002415','000001','002153','603708','002697','601808','002414','601601',
'601319','300529','603679','002429','002705','300632','603033','600862',
'601689','300497','002082','002171','600456','603393','002129','601137',
'002241','002460','000063','600273','300133','300251','000875','002607',
'300003','601888','300122','300357','601678','300419','000876','002605',
'603208','603068','300130','600984','300096','603997','002213','002498',
'600846','601997','300312','000913','300256','000925','002105','002634',
'300209','603042','002621','600876','002606','002841','002865','300552',
'002458','002022','002271','300502','002869','300014','002803','002014',
'002812','002436','600794','002918','300737','000635','002791','300659',
'002821','603327') and TRADE_DATE>='2004-01-01' and OPEN_PRICE_2!=0 order by trade_date

 '''
data = pd.read_sql_query(sql, engine)
print(data.head())
for i in set(data['TICKER_SYMBOL']):
    stock = data[data['TICKER_SYMBOL']== i]
    stock.to_csv('./Data/original_data/'+i+'.csv', index=False)
    print(i)
   # break